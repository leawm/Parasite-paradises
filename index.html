<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Parasites paradises</title>
	<script src="build/p5.js"></script>
	<script src="build/p5.dom.js"></script>
	<script src="build/p5.sound.js"></script>



	<style>
		body {
			margin:0;
			padding:0;
			overflow: hidden;

		}
		canvas {
	width: 100%; height: 100%
		}
            }
	</style>
</head>

<body>
	<canvas id="myCanvas"></canvas>
  <link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="stylesheet" type="text/css" href="font/font.css" />

	<script src="build/three.js"></script>
	<script src="js/OrbitControls.js"></script>
	<script src="js/Reflector.js"></script>


<script>

	var renderer,
	controls,
	scene,
	camera,
	myCanvas = document.getElementById('myCanvas');

  var keyboard = {};
	var player = {height:-2};




	//RENDERER
  renderer = new THREE.WebGLRenderer({canvas: myCanvas, antialias: true});
  //renderer.setClearColor(0x000000); //background color par d√©faut
	renderer.setPixelRatio(window.devicePixelRatio);
	renderer.setSize( window.innerWidth, window.innerHeight );
	document.body.appendChild( renderer.domElement );

	//CAMERA
	camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 0.1, 2000 );
	camera.position.set( 0, player.height, 70 );
	camera.lookAt(new THREE.Vector3(0,player.height,0));


  //CONTROLS
  controls = new THREE.OrbitControls( camera, renderer.domElement );




	//SCENE
	scene = new THREE.Scene();

	//LIGHTS
	var light = new THREE.AmbientLight(0xffffff, 0.2);
	scene.add(light);
	var light2 = new THREE.DirectionalLight(0xFFFFFF, 0.7);
	light2.position.set(0,0,1);
	scene.add(light2);


// PANNEAUX IMAGES

	//VIDEO

var video = document.createElement( 'video' );

video.crossOrigin = 'anonymous';
video.width = 1080;
video.height = 720;
video.loop = true;
video.muted = true;
video.src = 'textures/morphing.mov';
video.setAttribute( 'webkit-playsinline', 'webkit-playsinline' );
video.play();

//TEXTURE
var img1 = new THREE.TextureLoader().load( "textures/1.png" );
var img2 = new THREE.TextureLoader().load( "textures/2.png" );
var img3 = new THREE.TextureLoader().load( "textures/3.png" );
var img4 = new THREE.TextureLoader().load( "textures/4.png" );
var img5 = new THREE.TextureLoader().load( "textures/5.png" );
var img6 = new THREE.TextureLoader().load( "textures/6.png" );
var img7 = new THREE.TextureLoader().load( "textures/7.png" );
var img8 = new THREE.TextureLoader().load( "textures/8.png" );
var img9= new THREE.TextureLoader().load( "textures/9.png" );
var img10 = new THREE.TextureLoader().load( "textures/10.png" );
var img11 = new THREE.TextureLoader().load( "textures/11.png" );
var img12 = new THREE.TextureLoader().load( "textures/112.png" );
//texture.minFilter = THREE.NearestFilter;
//texture.format = THREE.RGBFormat;
img2.wrapS = THREE.RepeatWrapping;
img2.wrapT = THREE.RepeatWrapping;
img2.repeat.set( 1, 1);

var texture = [
new THREE.MeshBasicMaterial({color: 0x878787, side: THREE.DoubleSide}),// RIGHT
new THREE.MeshBasicMaterial({color: 0x878787, side: THREE.BackSide}), //LEFT
new THREE.MeshBasicMaterial({color: 0x878787, side: THREE.DoubleSide}), //TOP
new THREE.MeshBasicMaterial({color: 0x878787, side: THREE.DoubleSide}),//BOTTOM
//new THREE.MeshBasicMaterial({map: new THREE.VideoTexture(video), side: THREE.DoubleSide}),//FRONT
new THREE.MeshBasicMaterial({map: img1, side: THREE.DoubleSide}),//FRONT
new THREE.MeshBasicMaterial({map: img1, side: THREE.DoubleSide})//BACK

];

var material = new THREE.MeshFaceMaterial(texture);
var material2 = new THREE.MeshLambertMaterial({map: img2,});
var material3 = new THREE.MeshLambertMaterial({map: img3,});
var material4 = new THREE.MeshLambertMaterial({map: img4,});
var material5 = new THREE.MeshLambertMaterial({map: img5,});
var material6 = new THREE.MeshLambertMaterial({map: img6,});
var material7 = new THREE.MeshLambertMaterial({map: img7,});
var material8 = new THREE.MeshLambertMaterial({map: img8,});
var material9 = new THREE.MeshLambertMaterial({map: img9,});
var material10 = new THREE.MeshLambertMaterial({map: img10,});

var geometry = new THREE.BoxGeometry(37,23,0.5);
var geometry2 = new THREE.BoxGeometry(37,23,0.5);
var geometry3 = new THREE.BoxGeometry(37,23,0.5);
var geometry4 = new THREE.BoxGeometry(37,23,0.5);
var geometry5 = new THREE.BoxGeometry(37,23,0.5);
var geometry6 = new THREE.BoxGeometry(37,23,0.5);
var geometry7 = new THREE.BoxGeometry(37,23,0.5);
var geometry8 = new THREE.BoxGeometry(37,23,0.5);
var geometry9 = new THREE.BoxGeometry(37,23,0.5);
var geometry10 = new THREE.BoxGeometry(37,23,0.5);

var mesh = new THREE.Mesh( geometry, material );
var mesh2 = new THREE.Mesh( geometry2, material2 );
var mesh3 = new THREE.Mesh( geometry3, material3 );
var mesh4 = new THREE.Mesh( geometry4, material4 );
var mesh5 = new THREE.Mesh( geometry5, material5 );
var mesh6 = new THREE.Mesh( geometry6, material6 );
var mesh7 = new THREE.Mesh( geometry7, material7 );
var mesh8 = new THREE.Mesh( geometry8, material8 );
var mesh9 = new THREE.Mesh( geometry9, material9 );
var mesh10 = new THREE.Mesh( geometry10, material10 );



		  //mesh.position.set( 0, 2, 100 );
			//mesh2.position.set( -30, 2, 90);
			//mesh3.position.set( 20, 2, -70);
			//mesh4.position.set( 0, 2, 0);
			//mesh5.position.set( -10, 2, 20);
			//mesh6.position.set( 30, 2, 40);
			//mesh7.position.set( 0, 2, -85);
			//mesh8.position.set( -10, 2, 60);
			//mesh9.position.set( -5, 2, -50);
			//mesh10.position.set(40, 2, -80);

			mesh.position.set( 0, -2, 0 );
			mesh2.position.set( 0, -2, -30);
			mesh3.position.set( 0, -2, -60);
			mesh4.position.set( 0, -2, -90);
			mesh5.position.set( 0, -2, -120);
			mesh6.position.set( 0, -2, -150);
			mesh7.position.set( 0, -2, -180);
			mesh8.position.set( 0, -2, -210);
			mesh9.position.set( 0, -2, -240);
			mesh10.position.set(0, -2, -270);

			mesh.rotation.set( 0, 0, -0.05 );
			mesh2.rotation.set( 0, 0, 0.05 );
			mesh3.rotation.set( 0, 0, -0.07 );
			mesh4.rotation.set( 0, 0, -0.02 );
			mesh5.rotation.set( 0, 0, 0.05 );
			mesh6.rotation.set( 0, 0, 0.09 );
			mesh7.rotation.set( 0, 0, -0.03 );
			mesh8.rotation.set( 0, 0, 0.02 );
			mesh9.rotation.set( 0, 0, 0.05 );
			mesh10.rotation.set( 0, 0, -0.05 );

			scene.add( mesh );
			scene.add( mesh2 );
			scene.add( mesh3 );
			scene.add( mesh4 );
			scene.add( mesh5 );
			scene.add( mesh6 );
			scene.add( mesh7 );
			scene.add( mesh8 );
			scene.add( mesh9 );
			scene.add( mesh10 );

//GROUND

var ground = new THREE.PlaneGeometry(400,1000,10,10);
var groundMirror = new THREE.Reflector( ground, {
clipBias:0.003,
textureWidth: 30 * window.devicePixelRatio,
textureHeight: 30 * window.devicePixelRatio,
color: 0x737373,
recursion: 3
} );
groundMirror.position.y = -10;
groundMirror.rotation.x-= Math.PI/2;
scene.add( groundMirror );


// BACKGROUND

  var backgroundMesh, backgroundScene, backgroundCamera;


  backgroundMesh = new THREE.Mesh(new THREE.SphereGeometry(80,80,80),
	new THREE.MeshBasicMaterial({
	map: new THREE.VideoTexture(video),
  side: THREE.DoubleSide})
 );

	//backgroundMesh.material.depthTest = false;
	//backgroundMesh.material.depthWrite = false;

	backgroundScene = new THREE.Scene();
	backgroundCamera = new THREE.Camera();
	//backgroundScene.add(backgroundCamera);
	//backgroundScene.add(backgroundMesh);

	backgroundMesh.position.set = (0,0,-100);
  //scene.add( backgroundMesh );


  requestAnimationFrame( animate );



// RENDER LOOP
	animate();

	function animate() {

		if(keyboard[38]){ //up arrow key
			//camera.position.y += Math.PI*0.9;
			camera.position.z -= Math.PI*0.03;
			//groundMirror.position.z -= Math.PI*0.1;
			//backgroundMesh.position.z -= Math.PI*0.1;

		}

		if(keyboard[40]){// down arrow key
			//camera.position.y -= Math.PI*0.9;
			camera.position.z += Math.PI*0.03;
			//groundMirror.position.z += Math.PI*0.1;
			//backgroundMesh.position.z += Math.PI*0.1;

		}

		if(keyboard[37]){ //left arrow key
			camera.rotation.y += Math.PI*0.0009;
		}

		if(keyboard[39]){// right arrow key
			camera.rotation.y -= Math.PI*0.0009;
		}

		if(keyboard[87]){ //W key
			camera.rotation.x += Math.PI*0.0009;
		}

		if(keyboard[88]){ //X key
			camera.rotation.x -= Math.PI*0.0009;
		}

		//mesh.rotation.x += 0.002;
    //mesh.rotation.y += 0.002;
    renderer.autoClear = false;
		renderer.clear();
    renderer.render( backgroundScene, backgroundCamera );
    renderer.render( scene, camera );
		requestAnimationFrame( animate );

	}



	function keyDown (event){
		keyboard[event.keyCode]=true;
	}

	function keyUp(event){
	  keyboard[event.keyCode]=false;
	}

	window.addEventListener('keydown', keyDown);
	window.addEventListener('keyup', keyUp);


	  </script>
	</body>
</html>
